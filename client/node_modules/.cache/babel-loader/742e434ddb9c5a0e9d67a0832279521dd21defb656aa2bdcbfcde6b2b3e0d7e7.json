{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import queryString from\"query-string\";import io from\"socket.io-client\";import InfoBar from\"./../InfoBar/InfoBar.js\";import Input from\"./../Input/Input.js\";import Messages from\"../Messages/Messages.js\";import TextContainer from\"../TextContainer/TextContainer.js\";import\"./Chat.css\";import{useLocation}from\"react-router\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ENDPOINT=\"http://localhost:5000/\";let socket;const Chat=()=>{const location=useLocation();const[name,setName]=useState(\"\");const[room,setRoom]=useState(\"\");const[users,setUsers]=useState(\"\");const[message,setMessage]=useState(\"\");const[messages,setMessages]=useState([]);useEffect(()=>{const{name,room}=queryString.parse(location.search);socket=io(ENDPOINT,{cors:{origin:\"http://localhost:5000\",credentials:true},transports:[\"websocket\"]});setRoom(room);setName(name);socket.emit(\"join\",{name,room},error=>{if(error){alert(error);}});},[ENDPOINT,location.search]);useEffect(()=>{socket.on(\"message\",message=>{setMessages(messages=>[...messages,message]);});socket.on(\"roomData\",_ref=>{let{users}=_ref;setUsers(users);});},[]);const sendMessage=event=>{event.preventDefault();if(message){socket.emit(\"sendMessage\",message,()=>setMessage(\"\"));}};console.log(message,messages);return/*#__PURE__*/_jsxs(\"div\",{className:\"outerContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(InfoBar,{room:room}),/*#__PURE__*/_jsx(Messages,{messages:messages,name:name}),/*#__PURE__*/_jsx(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage})]}),/*#__PURE__*/_jsx(TextContainer,{users:users})]});};export default Chat;","map":{"version":3,"names":["React","useState","useEffect","queryString","io","InfoBar","Input","Messages","TextContainer","useLocation","jsx","_jsx","jsxs","_jsxs","ENDPOINT","socket","Chat","location","name","setName","room","setRoom","users","setUsers","message","setMessage","messages","setMessages","parse","search","cors","origin","credentials","transports","emit","error","alert","on","_ref","sendMessage","event","preventDefault","console","log","className","children"],"sources":["C:/Users/Paarthurnax/Documents/desiqna/Dev Prep/React/group-chat/client/src/components/Chat/Chat.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport queryString from \"query-string\";\r\nimport io from \"socket.io-client\";\r\nimport InfoBar from \"./../InfoBar/InfoBar.js\";\r\nimport Input from \"./../Input/Input.js\";\r\nimport Messages from \"../Messages/Messages.js\";\r\nimport TextContainer from \"../TextContainer/TextContainer.js\";\r\n\r\nimport \"./Chat.css\";\r\nimport { useLocation } from \"react-router\";\r\n\r\nconst ENDPOINT = \"http://localhost:5000/\";\r\n\r\nlet socket;\r\n\r\nconst Chat = () => {\r\n  const location = useLocation();\r\n\r\n  const [name, setName] = useState(\"\");\r\n  const [room, setRoom] = useState(\"\");\r\n  const [users, setUsers] = useState(\"\");\r\n  const [message, setMessage] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const { name, room } = queryString.parse(location.search);\r\n\r\n    socket = io(ENDPOINT, {\r\n      cors: {\r\n        origin: \"http://localhost:5000\",\r\n        credentials: true,\r\n      },\r\n      transports: [\"websocket\"],\r\n    });\r\n\r\n    setRoom(room);\r\n    setName(name);\r\n\r\n    socket.emit(\"join\", { name, room }, (error) => {\r\n      if (error) {\r\n        alert(error);\r\n      }\r\n    });\r\n  }, [ENDPOINT, location.search]);\r\n\r\n  useEffect(() => {\r\n    socket.on(\"message\", (message) => {\r\n      setMessages((messages) => [...messages, message]);\r\n    });\r\n\r\n    socket.on(\"roomData\", ({ users }) => {\r\n      setUsers(users);\r\n    });\r\n  }, []);\r\n\r\n  const sendMessage = (event) => {\r\n    event.preventDefault();\r\n\r\n    if (message) {\r\n      socket.emit(\"sendMessage\", message, () => setMessage(\"\"));\r\n    }\r\n  };\r\n\r\n  console.log(message, messages);\r\n\r\n  return (\r\n    <div className=\"outerContainer\">\r\n      <div className=\"container\">\r\n        <InfoBar room={room} />\r\n        <Messages messages={messages} name={name}/>\r\n        <Input\r\n          message={message}\r\n          setMessage={setMessage}\r\n          sendMessage={sendMessage}\r\n        />\r\n      </div>\r\n      <TextContainer users={users}/>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}